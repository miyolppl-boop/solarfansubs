<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>SolarFansub</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
*{box-sizing:border-box}
body{margin:0;font-family:Arial;background:#0c0c0c;color:#eee}
header{background:#000;padding:12px 16px;display:flex;justify-content:space-between;align-items:center}
.logo{color:#f5d76e;font-size:20px;font-weight:bold;cursor:pointer}
input,textarea,button,select{padding:8px;border-radius:6px;border:none;width:100%;margin:4px 0}
button{background:#f5d76e;color:#000;cursor:pointer}
.container{padding:16px}
.section-title{font-size:20px;color:#f5d76e;border-bottom:2px solid #f5d76e;margin:25px 0 10px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:15px}
.card{background:#151515;border-radius:8px;padding:10px;text-align:center;cursor:pointer}
.card img{width:100%;height:230px;object-fit:cover;border-radius:6px}
.hidden{display:none}
.star{font-size:22px;color:#444;cursor:pointer}
.star.active{color:#f5d76e}
.chapter{background:#1f1f1f;padding:10px;border-radius:6px;margin:6px 0;cursor:pointer}
.new{color:#0f0;font-size:12px;margin-left:6px}
.reader img{width:100%;margin-bottom:10px}
.admin-box{position:fixed;right:10px;bottom:10px;background:#111;padding:10px;border-radius:8px;width:260px}
</style>
</head>

<body>

<header>
<div class="logo" onclick="goHome()">SolarFansub</div>
<input id="search" placeholder="Seri ara..." oninput="renderSeries()">
</header>

<div id="home" class="container"></div>
<div id="detail" class="container hidden"></div>
<div id="reader" class="container hidden reader"></div>

<div class="admin-box" id="adminLoginBox">
<input id="adminPass" type="password" placeholder="Admin ÅŸifre">
<button onclick="adminLogin()">Admin GiriÅŸ</button>
</div>

<div class="container hidden" id="adminPanel">
<h2>Admin Paneli</h2>

<input id="sTitle" placeholder="Seri adÄ±">
<input id="sCover" type="file" accept="image/*">
<textarea id="sDesc" placeholder="AÃ§Ä±klama"></textarea>
<input id="sGenres" placeholder="TÃ¼rler (virgÃ¼lle)">
<select id="sStatus">
<option>Devam Ediyor</option>
<option>Bitti</option>
</select>
<button onclick="addSeries()">â• Seri Ekle</button>

<hr>

<select id="seriesSelect"></select>
<input id="cTitle" placeholder="BÃ¶lÃ¼m adÄ±">
<textarea id="cPages" placeholder="Sayfa URL'leri (her satÄ±r 1 resim)"></textarea>
<button onclick="addChapter()">ğŸ“š BÃ¶lÃ¼m Ekle</button>

<button onclick="logout()">ğŸšª Admin Ã‡Ä±kÄ±ÅŸ</button>
</div>

<script>
const ADMIN_PASSWORDS=["alamuzpulums&129qam","admin2"];
let data=JSON.parse(localStorage.getItem("DATA"))||{series:[]};
let favs=JSON.parse(localStorage.getItem("FAVS"))||[];

function save(){localStorage.setItem("DATA",JSON.stringify(data))}
function avg(s){return s.rating.length? s.rating.reduce((a,b)=>a+b,0)/s.rating.length:0}

function goHome(){
detail.classList.add("hidden");
reader.classList.add("hidden");
home.classList.remove("hidden");
renderSeries();
}

function renderSeries(){
home.innerHTML="";
let now=Date.now();

let weekPopular=[...data.series].sort((a,b)=>b.views-a.views)[0];
let mostRead=[...data.series].sort((a,b)=>b.views-a.views).slice(0,6);
let popular=[...data.series].sort((a,b)=>avg(b)-avg(a)).slice(0,6);
let others=[...data.series].filter(s=>!popular.includes(s));

let html="";

if(weekPopular){
html+=`<div class="section-title">ğŸ”¥ HaftanÄ±n PopÃ¼leri</div><div class="grid">${card(weekPopular)}</div>`;
}

html+=`<div class="section-title">ğŸ‘ En Ã‡ok Okunanlar</div><div class="grid">${mostRead.map(card).join("")}</div>`;
html+=`<div class="section-title">â­ PopÃ¼ler Seriler</div><div class="grid">${popular.map(card).join("")}</div>`;
html+=`<div class="section-title">ğŸ“š DiÄŸer Seriler</div><div class="grid">${others.map(card).join("")}</div>`;

home.innerHTML=html;
}

function card(s){
return `<div class="card" onclick="openSeries(${s.id})">
<img src="${s.cover}">
<b>${s.title}</b>
</div>`;
}

function openSeries(id){
const s=data.series.find(x=>x.id===id);
s.views++; save();
home.classList.add("hidden");
detail.classList.remove("hidden");

detail.innerHTML=`
<h2>${s.title}</h2>
<img src="${s.cover}" style="max-width:240px">
<p>${s.desc}</p>
<p><b>TÃ¼rler:</b> ${s.genres.join(", ")}</p>
<p><b>Durum:</b> ${s.status}</p>
<p><b>Favori:</b> ${favs.filter(f=>f===id).length}</p>

<button onclick="toggleFav(${id})">â­ Takip Et</button>

<h3>BÃ¶lÃ¼mler</h3>
${s.chapters.map(c=>`
<div class="chapter" onclick="openChapter(${id},${c.id})">
${c.title} ${Date.now()-c.created<86400000?'<span class="new">NEW</span>':''}
</div>`).join("")}
`;
}

function toggleFav(id){
if(!favs.includes(id)) favs.push(id);
localStorage.setItem("FAVS",JSON.stringify(favs));
alert("Favorilere eklendi");
}

function openChapter(sid,cid){
const s=data.series.find(x=>x.id===sid);
const c=s.chapters.find(x=>x.id===cid);
detail.classList.add("hidden");
reader.classList.remove("hidden");
reader.innerHTML=c.pages.map(p=>`<img src="${p}">`).join("");
}

function adminLogin(){
if(ADMIN_PASSWORDS.includes(adminPass.value)){
adminLoginBox.classList.add("hidden");
adminPanel.classList.remove("hidden");
updateSeriesSelect();
}else alert("HatalÄ± ÅŸifre");
}

function logout(){
adminPanel.classList.add("hidden");
adminLoginBox.classList.remove("hidden");
}

function addSeries(){
const file=sCover.files[0];
const r=new FileReader();
r.onload=e=>{
data.series.push({
id:Date.now(),
title:sTitle.value,
cover:e.target.result,
desc:sDesc.value,
genres:sGenres.value.split(","),
status:sStatus.value,
rating:[],
views:0,
chapters:[]
});
save(); renderSeries(); updateSeriesSelect();
};
r.readAsDataURL(file);
}

function addChapter(){
const s=data.series.find(x=>x.id==seriesSelect.value);
s.chapters.push({
id:Date.now(),
title:cTitle.value,
pages:cPages.value.split("\n"),
created:Date.now()
});
save(); alert("BÃ¶lÃ¼m eklendi");
}

function updateSeriesSelect(){
seriesSelect.innerHTML=data.series.map(s=>`<option value="${s.id}">${s.title}</option>`).join("");
}

renderSeries();
</script>

</body>
</html>
