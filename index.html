<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SolarFansub</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<style>
body{margin:0;font-family:Arial;background:#000;color:#fff}
header{
position:fixed;top:0;left:0;
width:100%;
background:#000;z-index:1000;
display:flex;justify-content:space-between;
align-items:center;padding:15px;
border-bottom:1px solid #222;
box-sizing:border-box
}
.logo{color:#FFD84D;font-weight:bold}
.menu-btn{font-size:26px;color:#FFD84D;cursor:pointer}

.section{padding:90px 15px}
.title{font-size:22px;border-left:4px solid #FFD84D;padding-left:10px;margin:15px 0}

.card{
background:#111;border:1px solid #222;
border-radius:12px;padding:15px;
margin-bottom:12px;cursor:pointer
}
.card:hover{border-color:#FFD84D}

.side-menu{
position:fixed;
top:0;right:-100%;
width:85%;max-width:320px;
height:100%;
background:#0c0c0c;
padding:20px;
transition:.3s;
z-index:2000;
overflow-y:auto;
box-sizing:border-box
}
.side-menu.active{right:0}

.side-menu button,.side-menu a{
width:100%;margin-bottom:10px;
padding:12px;border-radius:8px;
border:none;background:#FFD84D;
color:#000;font-weight:bold;
text-decoration:none;display:block
}
.side-menu a{background:#111;color:#FFD84D}

.input,textarea{
width:100%;padding:12px;
margin-bottom:10px;
border-radius:8px;border:none;
background:#222;color:#fff;
box-sizing:border-box
}

.search{
width:100%;padding:12px;
border-radius:10px;border:none;
background:#222;color:#fff;
margin-bottom:15px
}

.reader img{
width:100%;
margin-bottom:10px;
border-radius:6px
}

.reader-nav{
display:flex;justify-content:space-between;
gap:10px;margin:15px 0
}
.reader-nav button{
flex:1;padding:12px;
border:none;border-radius:8px;
background:#FFD84D;color:#000;
font-weight:bold
}

.new-badge{
background:#ff2d2d;color:#fff;
font-size:11px;padding:3px 6px;
border-radius:6px;margin-left:6px
}

.modal{
position:fixed;inset:0;
background:rgba(0,0,0,.85);
display:none;
align-items:center;
justify-content:center;
z-index:3000
}
.modal-box{
background:#111;
padding:20px;
border-radius:12px;
width:90%;max-width:360px
}

footer{text-align:center;color:#777;padding:30px;font-size:12px}
</style>
</head>

<body>

<header>
<div class="logo">☀ SolarFansub</div>
<div class="menu-btn" onclick="toggleMenu()">☰</div>
</header>

<div class="side-menu" id="menu">
<button onclick="openLogin()">Üye Girişi</button>
<button onclick="openRegister()">Üye Kaydı</button>
<a onclick="showHome()">Ana Sayfa</a>
<a onclick="showFavorites()">Favoriler</a>
<a onclick="adminLogin()">Admin Panel</a>
</div>

<div class="section" id="content"></div>
<footer>© SolarFansub</footer>

<!-- LOGIN -->
<div class="modal" id="loginModal">
<div class="modal-box">
<h3>Üye Girişi</h3>
<input class="input" id="loginEmail" placeholder="E-posta">
<input class="input" id="loginPassword" type="password" placeholder="Şifre">
<button onclick="login()">Giriş Yap</button>
<button onclick="closeModals()">Kapat</button>
</div>
</div>

<!-- REGISTER -->
<div class="modal" id="registerModal">
<div class="modal-box">
<h3>Üye Kaydı</h3>
<input class="input" id="regEmail" placeholder="E-posta">
<input class="input" id="regPassword" type="password" placeholder="Şifre">
<button onclick="register()">Kayıt Ol</button>
<button onclick="closeModals()">Kapat</button>
</div>
</div>

<script>
firebase.initializeApp({
apiKey:"AIzaSyCwXSQt42wLmbFvaUczzKMDUBPNfkH91S0",
authDomain:"solarfansubs-23416.firebaseapp.com",
projectId:"solarfansubs-23416",
storageBucket:"solarfansubs-23416.appspot.com"
});

const auth=firebase.auth();
const db=firebase.firestore();

auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL);

function toggleMenu(){menu.classList.toggle("active")}
function openLogin(){loginModal.style.display="flex"}
function openRegister(){registerModal.style.display="flex"}
function closeModals(){loginModal.style.display=registerModal.style.display="none"}

function login(){
if(!loginEmail.value||!loginPassword.value)return alert("Alanları doldur");
auth.signInWithEmailAndPassword(loginEmail.value,loginPassword.value)
.then(()=>{closeModals();alert("Giriş başarılı")})
.catch(e=>alert(e.message))
}
function register(){
if(!regEmail.value||!regPassword.value)return alert("Alanları doldur");
auth.createUserWithEmailAndPassword(regEmail.value,regPassword.value)
.then(()=>{closeModals();alert("Kayıt başarılı")})
.catch(e=>alert(e.message))
}

function showHome(){
content.innerHTML=`
<input class="search" placeholder="Seri ara..." oninput="searchSeries(this.value)">
<div class="title">New Episodes</div>`;
loadSeries();
}

function loadSeries(q=""){
db.collection("series").onSnapshot(s=>{
content.innerHTML=`
<input class="search" placeholder="Seri ara..." oninput="searchSeries(this.value)">
<div class="title">New Episodes</div>`;
s.forEach(d=>{
if(d.data().name.toLowerCase().includes(q.toLowerCase())){
content.innerHTML+=`
<div class="card" onclick="openSeries('${d.id}')">
${d.data().name}
</div>`;
}
});
});
}
function searchSeries(q){loadSeries(q)}

function openSeries(id){
db.collection("series").doc(id).get().then(d=>{
content.innerHTML=`
<div class="title">${d.data().name}</div>
<p>${d.data().desc}</p>
<button onclick="addFav('${id}')">⭐ Favori</button>`;
db.collection("series").doc(id).collection("chapters").orderBy("no")
.onSnapshot(c=>{
c.forEach(ch=>{
let isNew=Date.now()-ch.data().created<3*86400000;
content.innerHTML+=`
<div class="card" onclick="openReader('${id}',${ch.data().no})">
Bölüm ${ch.data().no}
${isNew?'<span class="new-badge">NEW</span>':''}
</div>`;
});
});
});
}

function openReader(id,no){
content.innerHTML=`
<div class="title">Bölüm ${no}</div>
<div class="reader">`;
for(let i=1;i<=5;i++){
content.innerHTML+=`<img src="https://via.placeholder.com/800x1200">`;
}
content.innerHTML+=`
</div>
<div class="reader-nav">
<button onclick="openReader('${id}',${no-1})">◀ Önceki</button>
<button onclick="openReader('${id}',${no+1})">Sonraki ▶</button>
</div>`;
}

function addFav(id){
let f=JSON.parse(localStorage.getItem("fav")||"[]");
if(!f.includes(id))f.push(id);
localStorage.setItem("fav",JSON.stringify(f));
alert("Favorilere eklendi");
}

function showFavorites(){
let f=JSON.parse(localStorage.getItem("fav")||"[]");
content.innerHTML=`<div class="title">Favoriler</div>`;
f.forEach(id=>{
db.collection("series").doc(id).get().then(d=>{
content.innerHTML+=`<div class="card">${d.data().name}</div>`;
});
});
}

function adminLogin(){
let p=prompt("Admin şifre");
if(p!=="alamuzpulum3929")return alert("Hatalı");
content.innerHTML=`
<div class="title">Admin Panel</div>
<input class="input" id="sname" placeholder="Seri Adı">
<textarea class="input" id="sdesc" placeholder="Konu"></textarea>
<button onclick="addSeries()">Seri Ekle</button>
<hr>
<input class="input" id="sid" placeholder="Seri ID">
<input class="input" id="chap" placeholder="Bölüm No">
<button onclick="addChapter()">Bölüm Ekle</button>`;
}

function addSeries(){
db.collection("series").add({
name:sname.value,
desc:sdesc.value,
created:Date.now()
});
alert("Seri eklendi");
}
function addChapter(){
db.collection("series").doc(sid.value)
.collection("chapters")
.add({no:Number(chap.value),created:Date.now()});
alert("Bölüm eklendi");
}

showHome();
</script>

</body>
</html>
