<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>SolarFansub</title>

<!-- SEO -->
<meta name="description" content="SolarFansub - Türkçe manhwa ve manga okuma sitesi. Güncel seriler, bölümler ve yorumlar.">
<meta name="keywords" content="solarfansub, manhwa oku, manga oku, türkçe manhwa, manhwa türkçe">
<meta name="author" content="SolarFansub">
<meta name="robots" content="index, follow">

<meta property="og:title" content="SolarFansub">
<meta property="og:description" content="Türkçe manhwa ve manga okuma sitesi">
<meta property="og:type" content="website">

<style>
body{margin:0;font-family:Arial;background:#0b0b0b;color:#f5f5dc}
header{background:#000;padding:15px;display:flex;gap:10px;align-items:center}
header h1{color:#f5d76e;margin:0;cursor:pointer}
input,textarea,button{padding:8px;border-radius:6px;border:none;width:100%}
button{background:#f5d76e;font-weight:bold;cursor:pointer}
.container{padding:20px}
.section{border-bottom:2px solid #f5d76e;margin:15px 0}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:15px}
.card{background:#111;border-radius:8px;overflow:hidden;cursor:pointer}
.card img{width:100%}
.card h3{padding:10px;font-size:14px}
.hidden{display:none}
.chapter{background:#111;padding:10px;border-radius:6px;margin-bottom:8px;cursor:pointer}
.reader img{width:100%;margin-bottom:10px}
.panel{background:#111;padding:15px;border-radius:8px;margin-bottom:20px}
.star{font-size:26px;color:#444;cursor:pointer}
.star.active{color:#f5d76e}

/* EKLENENLER */
.series-cover{display:block;margin:20px auto;max-width:260px;border-radius:10px}
.chapter-date{font-size:11px;color:#888;margin-top:4px}
.new-badge{background:#f5d76e;color:#000;font-size:10px;padding:2px 6px;border-radius:4px;margin-left:6px}
.read{opacity:.5}
</style>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
</head>

<body>

<header>
<h1 onclick="goHome()">SolarFansub</h1>
<input id="search" placeholder="Seri ara..." onkeyup="searchSeries()">
</header>

<div id="loginBox" class="container panel">
<h3>Admin Girişi</h3>
<input id="email" placeholder="E-mail">
<input id="password" type="password" placeholder="Şifre">
<button onclick="login()">Giriş</button>
</div>

<div id="adminPanel" class="container panel hidden">
<h3>Admin Panel</h3>
<input id="title" placeholder="Seri adı">
<textarea id="desc" placeholder="Seri konusu"></textarea>
<input type="file" id="coverFile" accept="image/*">
<button onclick="addSeries()">Seri Ekle</button>
</div>

<div id="home" class="container">
<h2 class="section">SERİLER</h2>
<div id="seriesList" class="grid"></div>
<p id="empty">Henüz seri yok.</p>
</div>

<div id="seriesPage" class="container hidden">
<button onclick="goHome()">⬅ Geri</button>
<h2 id="sTitle"></h2>
<img id="sCover" class="series-cover">
<p id="sDesc"></p>

<div id="ratingBox"></div>
<p id="avgRating"></p>

<h3 class="section">BÖLÜMLER</h3>
<div id="chapterList"></div>

<div id="chapterAdd" class="panel hidden">
<input id="newChapter" placeholder="Bölüm numarası">
<input type="file" id="pagesInput" accept="image/*" multiple>
<button onclick="addChapter()">Bölüm Ekle</button>
</div>
</div>

<div id="reader" class="container hidden reader">
<button onclick="backToSeries()">⬅ Geri</button>
<h2 id="chapterTitle"></h2>
<div id="pages"></div>
<div id="disqus_thread"></div>
</div>

<script>
const firebaseConfig={
 apiKey:"BURAYA",
 authDomain:"BURAYA",
 projectId:"BURAYA",
 storageBucket:"BURAYA.appspot.com",
 appId:"BURAYA"
};
firebase.initializeApp(firebaseConfig);

const auth=firebase.auth();
const db=firebase.firestore();
const storage=firebase.storage();

let currentSeries=null;

auth.onAuthStateChanged(u=>{
 if(u){loginBox.classList.add("hidden");adminPanel.classList.remove("hidden")}
 loadSeries();
});

function login(){
 auth.signInWithEmailAndPassword(email.value,password.value)
 .catch(()=>alert("Giriş hatalı"));
}

function goHome(){
 seriesPage.classList.add("hidden");
 reader.classList.add("hidden");
 home.classList.remove("hidden");
 loadSeries();
}

function addSeries(){
 const f=coverFile.files[0];
 const r=storage.ref("covers/"+Date.now()+f.name);
 r.put(f).then(()=>r.getDownloadURL().then(url=>{
  db.collection("series").add({
   title:title.value,
   desc:desc.value,
   cover:url,
   chapters:[],
   rating:{total:0,count:0}
  }).then(loadSeries);
 }));
}

function loadSeries(){
 seriesList.innerHTML="";
 db.collection("series").get().then(s=>{
  empty.style.display=s.empty?"block":"none";
  s.forEach(d=>{
   let x=d.data();x.id=d.id;
   let c=document.createElement("div");
   c.className="card";
   c.innerHTML=`<img src="${x.cover}"><h3>${x.title}</h3>`;
   c.onclick=()=>openSeries(x);
   seriesList.appendChild(c);
  });
 });
}

function searchSeries(){
 let v=search.value.toLowerCase();
 document.querySelectorAll(".card").forEach(c=>{
  c.style.display=c.innerText.toLowerCase().includes(v)?"block":"none";
 });
}

function openSeries(s){
 currentSeries=s;
 home.classList.add("hidden");
 seriesPage.classList.remove("hidden");
 sTitle.innerText=s.title;
 sCover.src=s.cover;
 sDesc.innerText=s.desc;

 chapterList.innerHTML="";
 let chapters=[...s.chapters].sort((a,b)=>new Date(b.date)-new Date(a.date));
 chapters.forEach(c=>{
  let isNew=(Date.now()-new Date(c.date))<3*86400000;
  let read=localStorage.getItem("read_"+s.id+"_"+c.num);
  chapterList.innerHTML+=`
   <div class="chapter ${read?"read":""}" onclick="openChapter(${s.chapters.indexOf(c)})">
    Bölüm ${c.num}
    ${isNew?'<span class="new-badge">YENİ</span>':""}
    <div class="chapter-date">${new Date(c.date).toLocaleDateString("tr-TR")}</div>
   </div>`;
 });

 chapterAdd.classList.toggle("hidden",!auth.currentUser);
}

function addChapter(){
 const files=[...pagesInput.files];
 let ups=[];
 files.forEach(f=>{
  let r=storage.ref("pages/"+Date.now()+f.name);
  ups.push(r.put(f).then(()=>r.getDownloadURL()));
 });
 Promise.all(ups).then(urls=>{
  currentSeries.chapters.push({
   num:newChapter.value,
   pages:urls,
   date:new Date().toISOString()
  });
  db.collection("series").doc(currentSeries.id)
  .update({chapters:currentSeries.chapters})
  .then(()=>openSeries(currentSeries));
 });
}

function openChapter(i){
 seriesPage.classList.add("hidden");
 reader.classList.remove("hidden");
 chapterTitle.innerText="Bölüm "+currentSeries.chapters[i].num;
 pages.innerHTML="";
 currentSeries.chapters[i].pages.forEach(p=>{
  pages.innerHTML+=`<img src="${p}">`;
 });
 localStorage.setItem("read_"+currentSeries.id+"_"+currentSeries.chapters[i].num,"1");
}

function backToSeries(){
 reader.classList.add("hidden");
 seriesPage.classList.remove("hidden");
}
</script>

</body>
</html>
